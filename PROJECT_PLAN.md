# ğŸ“‹ Plano do Projeto: Fraud Detection Data Pipeline

---

## ğŸ¯ Objetivo do Projeto

Construir um pipeline de dados completo para **prevenÃ§Ã£o de fraudes em cartÃµes de crÃ©dito**, simulando um ambiente real de banco/fintech, processando **50GB de dados financeiros sintÃ©ticos**.

---

## ğŸ§  O Que VocÃª Vai Aprender

### Habilidades TÃ©cnicas

| Ãrea | O que vai aprender |
|------|-------------------|
| **Data Generation** | Criar dados sintÃ©ticos realistas que simulam cenÃ¡rios de produÃ§Ã£o |
| **Streaming** | Processar dados em tempo real com Kafka |
| **Batch Processing** | Processar grandes volumes com Spark |
| **Data Lake** | Organizar dados em camadas (Medallion Architecture) |
| **Storage** | Usar MinIO como alternativa ao S3 |
| **SQL Analytics** | Criar queries analÃ­ticas para mÃ©tricas de negÃ³cio |
| **Data Visualization** | Construir dashboards com mÃ©tricas bancÃ¡rias |
| **Infrastructure** | Orquestrar mÃºltiplos serviÃ§os com Docker |

### Habilidades de NegÃ³cio

| Ãrea | O que vai aprender |
|------|-------------------|
| **Fraud Detection** | Regras reais usadas por bancos para detectar fraudes |
| **Banking KPIs** | MÃ©tricas que gestores e reguladores monitoram |
| **Compliance** | Conceitos de LGPD, BACEN, auditoria |
| **Risk Management** | Como classificar e priorizar riscos |
| **Chargeback Process** | Fluxo de disputas de transaÃ§Ãµes |

---

## ğŸ“š Como Vai Aprender

### MÃ©todo: Learn by Building

```
1. ENTENDER  â†’ Estudar o conceito teÃ³rico
2. PLANEJAR  â†’ Definir como implementar
3. FAZER     â†’ Construir na prÃ¡tica
4. QUEBRAR   â†’ Encontrar erros e limitaÃ§Ãµes
5. MELHORAR  â†’ Refatorar e otimizar
6. DOCUMENTAR â†’ Explicar o que fez
```

### Fases do Aprendizado

```
FASE 1: Fundamentos (Semana 1)
â”œâ”€â”€ Subir ambiente Docker na VPS
â”œâ”€â”€ Configurar ShadowTraffic
â”œâ”€â”€ Gerar primeiros dados (1GB teste)
â””â”€â”€ Validar que tudo funciona

FASE 2: Pipeline BÃ¡sico (Semana 2)
â”œâ”€â”€ Ler dados com Spark
â”œâ”€â”€ Criar camadas Bronze/Silver/Gold
â”œâ”€â”€ Salvar em formato Parquet
â””â”€â”€ Consultar dados processados

FASE 3: Regras de Fraude (Semana 3)
â”œâ”€â”€ Implementar as 8 regras de detecÃ§Ã£o
â”œâ”€â”€ Calcular fraud score
â”œâ”€â”€ Classificar transaÃ§Ãµes
â””â”€â”€ Validar precisÃ£o das regras

FASE 4: Operacional (Semana 4)
â”œâ”€â”€ Adicionar audit log
â”œâ”€â”€ Implementar blocklist
â”œâ”€â”€ Processar chargebacks
â””â”€â”€ Calcular mÃ©tricas de SLA

FASE 5: VisualizaÃ§Ã£o (Semana 5)
â”œâ”€â”€ Criar dashboard no Metabase
â”œâ”€â”€ Configurar Traefik (HTTPS)
â”œâ”€â”€ Gerar relatÃ³rios
â””â”€â”€ Documentar no GitHub

FASE 6: Escala (Semana 6)
â”œâ”€â”€ Processar os 50GB completos
â”œâ”€â”€ Medir performance
â”œâ”€â”€ Otimizar bottlenecks
â””â”€â”€ Preparar apresentaÃ§Ã£o
```

---

## ğŸ—ï¸ Arquitetura do Sistema

### VisÃ£o Geral (Lambda Architecture: Batch + Streaming)

O projeto implementa uma **Lambda Architecture** hÃ­brida, combinando processamento em batch (anÃ¡lises histÃ³ricas) com streaming em tempo real (detecÃ§Ã£o de fraudes instantÃ¢nea).

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                                         â”‚
â”‚                    ğŸ¦ FRAUD DETECTION PIPELINE - ARQUITETURA COMPLETA                   â”‚
â”‚                                                                                         â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•   â”‚
â”‚                                                                                         â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚                           ğŸ“Š DATA SOURCES (GeraÃ§Ã£o de Dados)                    â”‚  â”‚
â”‚   â”‚                                                                                 â”‚  â”‚
â”‚   â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”‚  â”‚
â”‚   â”‚    â”‚  ğŸ”„ STREAMING    â”‚              â”‚  ğŸ“¦ BATCH        â”‚                       â”‚  â”‚
â”‚   â”‚    â”‚                  â”‚              â”‚                  â”‚                       â”‚  â”‚
â”‚   â”‚    â”‚  ShadowTraffic   â”‚              â”‚  Python Scripts  â”‚                       â”‚  â”‚
â”‚   â”‚    â”‚  (Tempo Real)    â”‚              â”‚  (Faker pt_BR)   â”‚                       â”‚  â”‚
â”‚   â”‚    â”‚                  â”‚              â”‚                  â”‚                       â”‚  â”‚
â”‚   â”‚    â”‚  â€¢ 10 tx/segundo â”‚              â”‚  â€¢ 51M transaÃ§Ãµesâ”‚                       â”‚  â”‚
â”‚   â”‚    â”‚  â€¢ 2% taxa fraudeâ”‚              â”‚  â€¢ 100K clientes â”‚                       â”‚  â”‚
â”‚   â”‚    â”‚  â€¢ 24/7 contÃ­nuo â”‚              â”‚  â€¢ Dados ğŸ‡§ğŸ‡·     â”‚                       â”‚  â”‚
â”‚   â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â”‚  â”‚
â”‚   â”‚             â”‚                                 â”‚                                 â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                 â”‚                                 â”‚                                    â”‚
â”‚                 â–¼                                 â–¼                                    â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚                           ğŸ”€ DATA INGESTION (IngestÃ£o)                          â”‚  â”‚
â”‚   â”‚                                                                                 â”‚  â”‚
â”‚   â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”‚  â”‚
â”‚   â”‚    â”‚  ğŸ“¨ KAFKA        â”‚              â”‚  ğŸ“ JSON FILES   â”‚                       â”‚  â”‚
â”‚   â”‚    â”‚                  â”‚              â”‚                  â”‚                       â”‚  â”‚
â”‚   â”‚    â”‚  Topic:          â”‚              â”‚  /data/raw/      â”‚                       â”‚  â”‚
â”‚   â”‚    â”‚  transactions    â”‚              â”‚                  â”‚                       â”‚  â”‚
â”‚   â”‚    â”‚                  â”‚              â”‚  â€¢ customers.jsonâ”‚                       â”‚  â”‚
â”‚   â”‚    â”‚  â€¢ RetenÃ§Ã£o: 7d  â”‚              â”‚  â€¢ devices.json  â”‚                       â”‚  â”‚
â”‚   â”‚    â”‚  â€¢ PartiÃ§Ãµes: 3  â”‚              â”‚  â€¢ tx_*.json     â”‚                       â”‚  â”‚
â”‚   â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â”‚  â”‚
â”‚   â”‚             â”‚                                 â”‚                                 â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                 â”‚                                 â”‚                                    â”‚
â”‚                 â–¼                                 â–¼                                    â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚                           âš¡ SPARK PROCESSING (Processamento)                   â”‚  â”‚
â”‚   â”‚                                                                                 â”‚  â”‚
â”‚   â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”‚  â”‚
â”‚   â”‚    â”‚  ğŸŒŠ STREAMING    â”‚              â”‚  ğŸ“Š BATCH        â”‚                       â”‚  â”‚
â”‚   â”‚    â”‚                  â”‚              â”‚                  â”‚                       â”‚  â”‚
â”‚   â”‚    â”‚  Spark Structuredâ”‚              â”‚  Spark SQL       â”‚                       â”‚  â”‚
â”‚   â”‚    â”‚  Streaming       â”‚              â”‚  (PySpark)       â”‚                       â”‚  â”‚
â”‚   â”‚    â”‚                  â”‚              â”‚                  â”‚                       â”‚  â”‚
â”‚   â”‚    â”‚  â€¢ Micro-batch   â”‚              â”‚  â€¢ 5 Workers     â”‚                       â”‚  â”‚
â”‚   â”‚    â”‚  â€¢ Checkpoints   â”‚              â”‚  â€¢ 10 cores      â”‚                       â”‚  â”‚
â”‚   â”‚    â”‚  â€¢ Watermarks    â”‚              â”‚  â€¢ 15 GB RAM     â”‚                       â”‚  â”‚
â”‚   â”‚    â”‚  â€¢ LatÃªncia: ~1s â”‚              â”‚  â€¢ 85K tx/s      â”‚                       â”‚  â”‚
â”‚   â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â”‚  â”‚
â”‚   â”‚             â”‚                                 â”‚                                 â”‚  â”‚
â”‚   â”‚             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                 â”‚  â”‚
â”‚   â”‚                           â”‚                                                     â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                               â”‚                                                        â”‚
â”‚                               â–¼                                                        â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚                     ğŸ›ï¸ MEDALLION ARCHITECTURE (Data Lake)                       â”‚  â”‚
â”‚   â”‚                                                                                 â”‚  â”‚
â”‚   â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚  â”‚
â”‚   â”‚         â”‚  ğŸ”¶ BRONZE   â”‚â”€â”€â”€â–ºâ”‚  âšª SILVER   â”‚â”€â”€â”€â–ºâ”‚  ğŸ¥‡ GOLD     â”‚               â”‚  â”‚
â”‚   â”‚         â”‚              â”‚    â”‚              â”‚    â”‚              â”‚               â”‚  â”‚
â”‚   â”‚         â”‚  Dados Brutosâ”‚    â”‚ Dados Limpos â”‚    â”‚  AgregaÃ§Ãµes  â”‚               â”‚  â”‚
â”‚   â”‚         â”‚              â”‚    â”‚              â”‚    â”‚              â”‚               â”‚  â”‚
â”‚   â”‚         â”‚  â€¢ Raw JSON  â”‚    â”‚ â€¢ ValidaÃ§Ã£o  â”‚    â”‚ â€¢ MÃ©tricas   â”‚               â”‚  â”‚
â”‚   â”‚         â”‚  â€¢ Parquet   â”‚    â”‚ â€¢ GPS Dist   â”‚    â”‚ â€¢ Scores     â”‚               â”‚  â”‚
â”‚   â”‚         â”‚  â€¢ 5 GB      â”‚    â”‚ â€¢ Flags      â”‚    â”‚ â€¢ Alertas    â”‚               â”‚  â”‚
â”‚   â”‚         â”‚              â”‚    â”‚ â€¢ 5.4 GB     â”‚    â”‚ â€¢ 2 GB       â”‚               â”‚  â”‚
â”‚   â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚  â”‚
â”‚   â”‚                                                         â”‚                       â”‚  â”‚
â”‚   â”‚                            MinIO (S3-Compatible)        â”‚                       â”‚  â”‚
â”‚   â”‚                            s3a://fraud-data/medallion/  â”‚                       â”‚  â”‚
â”‚   â”‚                                                         â”‚                       â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                             â”‚                          â”‚
â”‚                                                             â–¼                          â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚                          ğŸ’¾ DATA WAREHOUSE (PostgreSQL)                         â”‚  â”‚
â”‚   â”‚                                                                                 â”‚  â”‚
â”‚   â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚  â”‚
â”‚   â”‚    â”‚                         fraud_db                                     â”‚    â”‚  â”‚
â”‚   â”‚    â”‚                                                                      â”‚    â”‚  â”‚
â”‚   â”‚    â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚    â”‚  â”‚
â”‚   â”‚    â”‚   â”‚ transactionsâ”‚  â”‚fraud_alerts â”‚  â”‚customer_    â”‚  â”‚ metrics_  â”‚  â”‚    â”‚  â”‚
â”‚   â”‚    â”‚   â”‚   (48M)     â”‚  â”‚   (1.8M)    â”‚  â”‚ summary     â”‚  â”‚  daily    â”‚  â”‚    â”‚  â”‚
â”‚   â”‚    â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚    â”‚  â”‚
â”‚   â”‚    â”‚                                                                      â”‚    â”‚  â”‚
â”‚   â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚  â”‚
â”‚   â”‚                                                                                 â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                             â”‚                          â”‚
â”‚                                                             â–¼                          â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚                           ğŸ“ˆ VISUALIZATION (BI & Dashboards)                    â”‚  â”‚
â”‚   â”‚                                                                                 â”‚  â”‚
â”‚   â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚
â”‚   â”‚    â”‚                        ğŸ¨ METABASE                                     â”‚  â”‚  â”‚
â”‚   â”‚    â”‚                                                                        â”‚  â”‚  â”‚
â”‚   â”‚    â”‚   â€¢ Dashboard de Fraudes (KPIs, GrÃ¡ficos, Mapas)                      â”‚  â”‚  â”‚
â”‚   â”‚    â”‚   â€¢ Alertas por NÃ­vel de Risco (CRÃTICO/ALTO/MÃ‰DIO/BAIXO)            â”‚  â”‚  â”‚
â”‚   â”‚    â”‚   â€¢ AnÃ¡lise por Estado/Categoria/HorÃ¡rio                              â”‚  â”‚  â”‚
â”‚   â”‚    â”‚   â€¢ MÃ©tricas de Efetividade (Recall: 90%, Precision: 17%)            â”‚  â”‚  â”‚
â”‚   â”‚    â”‚                                                                        â”‚  â”‚  â”‚
â”‚   â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚
â”‚   â”‚                                                                                 â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                             â”‚                          â”‚
â”‚                                                             â–¼                          â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚                           ğŸŒ ACCESS LAYER (Traefik + SSL)                       â”‚  â”‚
â”‚   â”‚                                                                                 â”‚  â”‚
â”‚   â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚  â”‚
â”‚   â”‚    â”‚                         HTTPS Endpoints                              â”‚    â”‚  â”‚
â”‚   â”‚    â”‚                                                                      â”‚    â”‚  â”‚
â”‚   â”‚    â”‚   ğŸ“Š metabase.abnerfonseca.com.br  â†’ Dashboard de BI                â”‚    â”‚  â”‚
â”‚   â”‚    â”‚   âš¡ spark.abnerfonseca.com.br     â†’ Spark Master UI                â”‚    â”‚  â”‚
â”‚   â”‚    â”‚   ğŸ“¦ minio.abnerfonseca.com.br     â†’ MinIO Console                  â”‚    â”‚  â”‚
â”‚   â”‚    â”‚   ğŸ”’ Let's Encrypt SSL             â†’ Certificados AutomÃ¡ticos       â”‚    â”‚  â”‚
â”‚   â”‚    â”‚                                                                      â”‚    â”‚  â”‚
â”‚   â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚  â”‚
â”‚   â”‚                                                                                 â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ComparaÃ§Ã£o: Batch vs Streaming

| Aspecto | ğŸ“¦ Batch | ğŸŒŠ Streaming |
|---------|----------|--------------|
| **Fonte** | JSON files (51GB) | ShadowTraffic â†’ Kafka |
| **Processamento** | Spark SQL | Spark Structured Streaming |
| **LatÃªncia** | ~34 min (pipeline completo) | ~1-5 segundos |
| **Throughput** | 85,000 tx/s | 10-100 tx/s (contÃ­nuo) |
| **Uso** | AnÃ¡lises histÃ³ricas, ML training | Alertas em tempo real |
| **Checkpoint** | N/A | MinIO (s3a://fraud-data/checkpoints) |

### Arquitetura Original (Detalhada)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                             â”‚
â”‚                         VPS OVH (8 cores / 24GB RAM)                        â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                        CAMADA DE GERAÃ‡ÃƒO                            â”‚   â”‚
â”‚  â”‚                                                                      â”‚   â”‚
â”‚  â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                  â”‚   â”‚
â”‚  â”‚   â”‚ ShadowTraffic â”‚  Gera 50GB de dados sintÃ©ticos:                â”‚   â”‚
â”‚  â”‚   â”‚              â”‚  â€¢ Customers (perfil + comportamento)            â”‚   â”‚
â”‚  â”‚   â”‚  (Gerador)   â”‚  â€¢ Cards (cartÃµes dos clientes)                 â”‚   â”‚
â”‚  â”‚   â”‚              â”‚  â€¢ Devices (dispositivos conhecidos)            â”‚   â”‚
â”‚  â”‚   â”‚              â”‚  â€¢ Transactions (95% legÃ­timas + 5% fraude)     â”‚   â”‚
â”‚  â”‚   â”‚              â”‚  â€¢ Chargebacks (disputas)                       â”‚   â”‚
â”‚  â”‚   â”‚              â”‚  â€¢ Blocklist (bloqueios)                        â”‚   â”‚
â”‚  â”‚   â”‚              â”‚  â€¢ Audit Log (compliance)                       â”‚   â”‚
â”‚  â”‚   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                                                  â”‚   â”‚
â”‚  â”‚          â”‚                                                           â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚             â”‚                                                               â”‚
â”‚             â–¼                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                     CAMADA DE STREAMING                             â”‚   â”‚
â”‚  â”‚                                                                      â”‚   â”‚
â”‚  â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                           â”‚   â”‚
â”‚  â”‚   â”‚    Kafka     â”‚â—„â”€â”€â”€â”€â–ºâ”‚  Zookeeper   â”‚                           â”‚   â”‚
â”‚  â”‚   â”‚              â”‚      â”‚              â”‚                           â”‚   â”‚
â”‚  â”‚   â”‚   Topics:    â”‚      â”‚ (Coordena o  â”‚                           â”‚   â”‚
â”‚  â”‚   â”‚   â€¢ customersâ”‚      â”‚   cluster)   â”‚                           â”‚   â”‚
â”‚  â”‚   â”‚   â€¢ cards    â”‚      â”‚              â”‚                           â”‚   â”‚
â”‚  â”‚   â”‚   â€¢ devices  â”‚      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                           â”‚   â”‚
â”‚  â”‚   â”‚   â€¢ transactions                                                â”‚   â”‚
â”‚  â”‚   â”‚   â€¢ chargebacks                                                 â”‚   â”‚
â”‚  â”‚   â”‚   â€¢ blocklist                                                   â”‚   â”‚
â”‚  â”‚   â”‚   â€¢ audit_log                                                   â”‚   â”‚
â”‚  â”‚   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                                                  â”‚   â”‚
â”‚  â”‚          â”‚                                                           â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚             â”‚                                                               â”‚
â”‚             â–¼                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                    CAMADA DE PROCESSAMENTO                          â”‚   â”‚
â”‚  â”‚                                                                      â”‚   â”‚
â”‚  â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                           â”‚   â”‚
â”‚  â”‚   â”‚ Spark Master â”‚â—„â”€â”€â”€â”€â–ºâ”‚ Spark Worker â”‚                           â”‚   â”‚
â”‚  â”‚   â”‚              â”‚      â”‚              â”‚                           â”‚   â”‚
â”‚  â”‚   â”‚  Coordena    â”‚      â”‚  8GB RAM     â”‚                           â”‚   â”‚
â”‚  â”‚   â”‚  os jobs     â”‚      â”‚  4 cores     â”‚                           â”‚   â”‚
â”‚  â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                           â”‚   â”‚
â”‚  â”‚                                                                      â”‚   â”‚
â”‚  â”‚   Jobs PySpark:                                                     â”‚   â”‚
â”‚  â”‚   â”œâ”€â”€ bronze_layer.py    (ingestÃ£o crua)                           â”‚   â”‚
â”‚  â”‚   â”œâ”€â”€ silver_layer.py    (limpeza e tipagem)                       â”‚   â”‚
â”‚  â”‚   â”œâ”€â”€ gold_layer.py      (agregaÃ§Ãµes de negÃ³cio)                   â”‚   â”‚
â”‚  â”‚   â””â”€â”€ fraud_detection.py (8 regras + score)                        â”‚   â”‚
â”‚  â”‚                                                                      â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚             â”‚                                                               â”‚
â”‚             â–¼                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                    CAMADA DE ARMAZENAMENTO                          â”‚   â”‚
â”‚  â”‚                                                                      â”‚   â”‚
â”‚  â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚   â”‚
â”‚  â”‚   â”‚                    MinIO                         â”‚              â”‚   â”‚
â”‚  â”‚   â”‚              (Data Lake - S3 Compatible)         â”‚              â”‚   â”‚
â”‚  â”‚   â”‚                                                  â”‚              â”‚   â”‚
â”‚  â”‚   â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚              â”‚   â”‚
â”‚  â”‚   â”‚   â”‚            BRONZE LAYER                â”‚    â”‚              â”‚   â”‚
â”‚  â”‚   â”‚   â”‚         "Dados crus, como chegaram"    â”‚    â”‚              â”‚   â”‚
â”‚  â”‚   â”‚   â”‚                                        â”‚    â”‚              â”‚   â”‚
â”‚  â”‚   â”‚   â”‚   /bronze/customers/                   â”‚    â”‚              â”‚   â”‚
â”‚  â”‚   â”‚   â”‚   /bronze/cards/                       â”‚    â”‚              â”‚   â”‚
â”‚  â”‚   â”‚   â”‚   /bronze/devices/                     â”‚    â”‚              â”‚   â”‚
â”‚  â”‚   â”‚   â”‚   /bronze/transactions/                â”‚    â”‚              â”‚   â”‚
â”‚  â”‚   â”‚   â”‚   /bronze/chargebacks/                 â”‚    â”‚              â”‚   â”‚
â”‚  â”‚   â”‚   â”‚   /bronze/blocklist/                   â”‚    â”‚              â”‚   â”‚
â”‚  â”‚   â”‚   â”‚   /bronze/audit_log/                   â”‚    â”‚              â”‚   â”‚
â”‚  â”‚   â”‚   â”‚                                        â”‚    â”‚              â”‚   â”‚
â”‚  â”‚   â”‚   â”‚   Formato: JSON/Parquet                â”‚    â”‚              â”‚   â”‚
â”‚  â”‚   â”‚   â”‚   Sem transformaÃ§Ã£o                    â”‚    â”‚              â”‚   â”‚
â”‚  â”‚   â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚              â”‚   â”‚
â”‚  â”‚   â”‚                       â”‚                          â”‚              â”‚   â”‚
â”‚  â”‚   â”‚                       â–¼                          â”‚              â”‚   â”‚
â”‚  â”‚   â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚              â”‚   â”‚
â”‚  â”‚   â”‚   â”‚            SILVER LAYER                â”‚    â”‚              â”‚   â”‚
â”‚  â”‚   â”‚   â”‚      "Dados limpos e padronizados"     â”‚    â”‚              â”‚   â”‚
â”‚  â”‚   â”‚   â”‚                                        â”‚    â”‚              â”‚   â”‚
â”‚  â”‚   â”‚   â”‚   â€¢ Tipos corrigidos                   â”‚    â”‚              â”‚   â”‚
â”‚  â”‚   â”‚   â”‚   â€¢ Timestamps convertidos             â”‚    â”‚              â”‚   â”‚
â”‚  â”‚   â”‚   â”‚   â€¢ Dados duplicados removidos         â”‚    â”‚              â”‚   â”‚
â”‚  â”‚   â”‚   â”‚   â€¢ Campos calculados adicionados      â”‚    â”‚              â”‚   â”‚
â”‚  â”‚   â”‚   â”‚   â€¢ Joins entre entidades              â”‚    â”‚              â”‚   â”‚
â”‚  â”‚   â”‚   â”‚                                        â”‚    â”‚              â”‚   â”‚
â”‚  â”‚   â”‚   â”‚   Formato: Delta Lake (Parquet)        â”‚    â”‚              â”‚   â”‚
â”‚  â”‚   â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚              â”‚   â”‚
â”‚  â”‚   â”‚                       â”‚                          â”‚              â”‚   â”‚
â”‚  â”‚   â”‚                       â–¼                          â”‚              â”‚   â”‚
â”‚  â”‚   â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚              â”‚   â”‚
â”‚  â”‚   â”‚   â”‚             GOLD LAYER                 â”‚    â”‚              â”‚   â”‚
â”‚  â”‚   â”‚   â”‚      "MÃ©tricas prontas para consumo"   â”‚    â”‚              â”‚   â”‚
â”‚  â”‚   â”‚   â”‚                                        â”‚    â”‚              â”‚   â”‚
â”‚  â”‚   â”‚   â”‚   â€¢ fraud_by_type                      â”‚    â”‚              â”‚   â”‚
â”‚  â”‚   â”‚   â”‚   â€¢ fraud_by_hour                      â”‚    â”‚              â”‚   â”‚
â”‚  â”‚   â”‚   â”‚   â€¢ approval_rate_daily                â”‚    â”‚              â”‚   â”‚
â”‚  â”‚   â”‚   â”‚   â€¢ false_positive_rate                â”‚    â”‚              â”‚   â”‚
â”‚  â”‚   â”‚   â”‚   â€¢ chargeback_rate                    â”‚    â”‚              â”‚   â”‚
â”‚  â”‚   â”‚   â”‚   â€¢ sla_metrics                        â”‚    â”‚              â”‚   â”‚
â”‚  â”‚   â”‚   â”‚   â€¢ rule_effectiveness                 â”‚    â”‚              â”‚   â”‚
â”‚  â”‚   â”‚   â”‚                                        â”‚    â”‚              â”‚   â”‚
â”‚  â”‚   â”‚   â”‚   Formato: Delta Lake (Parquet)        â”‚    â”‚              â”‚   â”‚
â”‚  â”‚   â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚              â”‚   â”‚
â”‚  â”‚   â”‚                                                  â”‚              â”‚   â”‚
â”‚  â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚   â”‚
â”‚  â”‚                                                                      â”‚   â”‚
â”‚  â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                  â”‚   â”‚
â”‚  â”‚   â”‚  PostgreSQL  â”‚  Armazena mÃ©tricas Gold para consulta rÃ¡pida    â”‚   â”‚
â”‚  â”‚   â”‚              â”‚  pelos dashboards                                â”‚   â”‚
â”‚  â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                  â”‚   â”‚
â”‚  â”‚                                                                      â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚             â”‚                                                               â”‚
â”‚             â–¼                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                     CAMADA DE VISUALIZAÃ‡ÃƒO                          â”‚   â”‚
â”‚  â”‚                                                                      â”‚   â”‚
â”‚  â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”‚
â”‚  â”‚   â”‚                        Metabase                             â”‚   â”‚   â”‚
â”‚  â”‚   â”‚                                                             â”‚   â”‚   â”‚
â”‚  â”‚   â”‚  Dashboard de BI para anÃ¡lise de fraudes                   â”‚   â”‚   â”‚
â”‚  â”‚   â”‚                                                             â”‚   â”‚   â”‚
â”‚  â”‚   â”‚  â€¢ KPIs de fraude (Recall, Precision, F1)                 â”‚   â”‚   â”‚
â”‚  â”‚   â”‚  â€¢ GrÃ¡ficos por categoria/estado/horÃ¡rio                   â”‚   â”‚   â”‚
â”‚  â”‚   â”‚  â€¢ Alertas por nÃ­vel de risco                              â”‚   â”‚   â”‚
â”‚  â”‚   â”‚  â€¢ MÃ©tricas financeiras (R$ protegido/perdido)            â”‚   â”‚   â”‚
â”‚  â”‚   â”‚                                                             â”‚   â”‚   â”‚
â”‚  â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   â”‚
â”‚  â”‚                                                                      â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚             â”‚                                                               â”‚
â”‚             â–¼                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                        CAMADA DE ACESSO                             â”‚   â”‚
â”‚  â”‚                                                                      â”‚   â”‚
â”‚  â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                  â”‚   â”‚
â”‚  â”‚   â”‚   Traefik    â”‚  Reverse proxy + SSL (Let's Encrypt)            â”‚   â”‚
â”‚  â”‚   â”‚              â”‚                                                  â”‚   â”‚
â”‚  â”‚   â”‚  Rotas:      â”‚                                                  â”‚   â”‚
â”‚  â”‚   â”‚  â€¢ metabase.abnerfonseca.com.br â†’ Metabase âœ…                  â”‚   â”‚
â”‚  â”‚   â”‚  â€¢ spark.abnerfonseca.com.br â†’ Spark UI âœ…                     â”‚   â”‚
â”‚  â”‚   â”‚  â€¢ minio.abnerfonseca.com.br â†’ MinIO Console âœ…                â”‚   â”‚
â”‚  â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                  â”‚   â”‚
â”‚  â”‚                                                                      â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â–¼
                              ğŸŒ INTERNET
                                    â”‚
                                    â–¼
                            ğŸ‘¨â€ğŸ’» VocÃª acessa
                              de qualquer lugar
```

---

## ğŸ“Š Entidades de Dados

### Modelo de Dados

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           MODELO DE DADOS                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  CUSTOMERS   â”‚         â”‚    CARDS     â”‚         â”‚   DEVICES    â”‚
    â”‚              â”‚         â”‚              â”‚         â”‚              â”‚
    â”‚ â€¢ customer_idâ”‚â—„â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚ â€¢ card_id    â”‚         â”‚ â€¢ device_id  â”‚
    â”‚ â€¢ demographics         â”‚ â€¢ customer_idâ”‚â—„â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚ â€¢ customer_idâ”‚
    â”‚   - name     â”‚         â”‚ â€¢ card_brand â”‚         â”‚ â€¢ device_typeâ”‚
    â”‚   - age      â”‚         â”‚ â€¢ card_type  â”‚         â”‚ â€¢ os         â”‚
    â”‚   - gender   â”‚         â”‚ â€¢ credit_limit         â”‚ â€¢ browser    â”‚
    â”‚   - profession         â”‚ â€¢ is_virtual â”‚         â”‚ â€¢ fingerprintâ”‚
    â”‚   - income   â”‚         â”‚ â€¢ is_contactless       â”‚ â€¢ is_trusted â”‚
    â”‚ â€¢ location   â”‚         â”‚              â”‚         â”‚              â”‚
    â”‚   - home_cityâ”‚         â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚   - home_lat â”‚                â”‚                        â”‚
    â”‚   - home_lng â”‚                â”‚                        â”‚
    â”‚   - usual_radius             â”‚                        â”‚
    â”‚ â€¢ behavior   â”‚                â”‚                        â”‚
    â”‚   - avg_spendâ”‚                â”‚                        â”‚
    â”‚   - avg_ticket               â”‚                        â”‚
    â”‚   - preferred_categories     â”‚                        â”‚
    â”‚   - usual_hours              â”‚                        â”‚
    â”‚ â€¢ risk       â”‚                â”‚                        â”‚
    â”‚   - credit_score             â”‚                        â”‚
    â”‚   - risk_profile             â–¼                        â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
                        â”‚      TRANSACTIONS        â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚                          â”‚
                        â”‚ â€¢ transaction_id         â”‚
                        â”‚ â€¢ card_id                â”‚
                        â”‚ â€¢ customer_id            â”‚
                        â”‚ â€¢ device_id              â”‚
                        â”‚ â€¢ amount                 â”‚
                        â”‚ â€¢ merchant               â”‚
                        â”‚   - name                 â”‚
                        â”‚   - category             â”‚
                        â”‚   - mcc                  â”‚
                        â”‚   - city                 â”‚
                        â”‚ â€¢ location               â”‚
                        â”‚   - lat/lng              â”‚
                        â”‚   - ip_address           â”‚
                        â”‚ â€¢ context                â”‚
                        â”‚   - channel              â”‚
                        â”‚   - has_pin              â”‚
                        â”‚   - has_3ds              â”‚
                        â”‚ â€¢ status                 â”‚
                        â”‚ â€¢ is_fraud               â”‚
                        â”‚ â€¢ fraud_type             â”‚
                        â”‚ â€¢ fraud_score            â”‚
                        â”‚ â€¢ timestamp              â”‚
                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                     â”‚
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚                        â”‚                        â”‚
            â–¼                        â–¼                        â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  CHARGEBACKS â”‚        â”‚  AUDIT_LOG   â”‚        â”‚  BLOCKLIST   â”‚
    â”‚              â”‚        â”‚              â”‚        â”‚              â”‚
    â”‚ â€¢ chargeback_id       â”‚ â€¢ log_id     â”‚        â”‚ â€¢ entry_id   â”‚
    â”‚ â€¢ transaction_id      â”‚ â€¢ transaction_id      â”‚ â€¢ type       â”‚
    â”‚ â€¢ reason     â”‚        â”‚ â€¢ action     â”‚        â”‚ â€¢ value_hash â”‚
    â”‚ â€¢ status     â”‚        â”‚ â€¢ fraud_scoreâ”‚        â”‚ â€¢ reason     â”‚
    â”‚ â€¢ is_friendly_fraud   â”‚ â€¢ rules_triggered     â”‚ â€¢ blocked_at â”‚
    â”‚ â€¢ opened_at  â”‚        â”‚ â€¢ response_time       â”‚ â€¢ blocked_by â”‚
    â”‚ â€¢ resolved_atâ”‚        â”‚ â€¢ decided_by â”‚        â”‚              â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ” Sistema de DetecÃ§Ã£o de Fraude

### As 8 Regras

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        REGRAS DE DETECÃ‡ÃƒO                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚   REGRA 1: CLONAGEM                                                         â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚  Se: mesma conta + cidades diferentes + intervalo < 30 minutos      â”‚   â”‚
â”‚   â”‚  EntÃ£o: suspeita de clonagem                                        â”‚   â”‚
â”‚   â”‚  Peso no score: 30 pontos                                           â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                              â”‚
â”‚   REGRA 2: TESTE DE CARTÃƒO                                                  â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚  Se: 3+ transaÃ§Ãµes < R$10 em 5 minutos                              â”‚   â”‚
â”‚   â”‚  EntÃ£o: suspeita de teste de cartÃ£o                                 â”‚   â”‚
â”‚   â”‚  Peso no score: 25 pontos                                           â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                              â”‚
â”‚   REGRA 3: GASTO ANORMAL                                                    â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚  Se: valor > 50% da mÃ©dia mensal do cliente                         â”‚   â”‚
â”‚   â”‚  EntÃ£o: suspeita de uso indevido                                    â”‚   â”‚
â”‚   â”‚  Peso no score: 15 pontos                                           â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                              â”‚
â”‚   REGRA 4: ACCOUNT TAKEOVER                                                 â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚  Se: device desconhecido + valor > R$500                            â”‚   â”‚
â”‚   â”‚  EntÃ£o: suspeita de roubo de conta                                  â”‚   â”‚
â”‚   â”‚  Peso no score: 25 pontos                                           â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                              â”‚
â”‚   REGRA 5: ANOMALIA GEOGRÃFICA                                              â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚  Se: distÃ¢ncia > 3x o raio habitual do cliente                      â”‚   â”‚
â”‚   â”‚  EntÃ£o: compra fora do padrÃ£o geogrÃ¡fico                            â”‚   â”‚
â”‚   â”‚  Peso no score: 20 pontos                                           â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                              â”‚
â”‚   REGRA 6: HORÃRIO ATÃPICO                                                  â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚  Se: hora da compra fora do horÃ¡rio usual do cliente                â”‚   â”‚
â”‚   â”‚  EntÃ£o: comportamento incomum                                       â”‚   â”‚
â”‚   â”‚  Peso no score: 10 pontos                                           â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                              â”‚
â”‚   REGRA 7: CATEGORIA SUSPEITA                                               â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚  Se: categoria de alto risco + primeira compra nessa categoria      â”‚   â”‚
â”‚   â”‚  Categorias: joias, eletrÃ´nicos, gambling, crypto, gift cards       â”‚   â”‚
â”‚   â”‚  Peso no score: 15 pontos                                           â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                              â”‚
â”‚   REGRA 8: INCOMPATIBILIDADE DE IDADE                                       â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚  Se: jovem (<25) + joias caras OU idoso (>70) + gaming              â”‚   â”‚
â”‚   â”‚  EntÃ£o: perfil incompatÃ­vel com compra                              â”‚   â”‚
â”‚   â”‚  Peso no score: 10 pontos                                           â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                           FRAUD SCORE                                        â”‚
â”‚                                                                              â”‚
â”‚   Score = soma dos pesos das regras ativadas (0 a 150 pontos)              â”‚
â”‚                                                                              â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚  Score 0-24:   LOW     â†’ âœ… Aprovar automaticamente                 â”‚   â”‚
â”‚   â”‚  Score 25-49:  MEDIUM  â†’ â¸ï¸ Enviar para revisÃ£o manual             â”‚   â”‚
â”‚   â”‚  Score 50+:    HIGH    â†’ âŒ Bloquear + ğŸ“± Alertar cliente          â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“ˆ KPIs e MÃ©tricas

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         MÃ‰TRICAS DO DASHBOARD                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚   ğŸ“Š OPERACIONAIS                                                           â”‚
â”‚   â”œâ”€â”€ Taxa de AprovaÃ§Ã£o (%)                                                 â”‚
â”‚   â”œâ”€â”€ Taxa de Bloqueio (%)                                                  â”‚
â”‚   â”œâ”€â”€ TransaÃ§Ãµes em RevisÃ£o (#)                                             â”‚
â”‚   â”œâ”€â”€ Tempo MÃ©dio de DecisÃ£o (ms)                                           â”‚
â”‚   â””â”€â”€ SLA Compliance (% < 100ms)                                            â”‚
â”‚                                                                              â”‚
â”‚   ğŸ¯ DETECÃ‡ÃƒO                                                               â”‚
â”‚   â”œâ”€â”€ Fraudes Detectadas (#)                                                â”‚
â”‚   â”œâ”€â”€ Fraudes por Tipo (breakdown)                                          â”‚
â”‚   â”œâ”€â”€ Precision (fraudes corretas / total bloqueado)                        â”‚
â”‚   â”œâ”€â”€ Recall (fraudes detectadas / total de fraudes)                        â”‚
â”‚   â””â”€â”€ F1 Score                                                              â”‚
â”‚                                                                              â”‚
â”‚   ğŸ’° FINANCEIRO                                                             â”‚
â”‚   â”œâ”€â”€ Valor Protegido (R$)                                                  â”‚
â”‚   â”œâ”€â”€ Perdas por Fraude (R$)                                                â”‚
â”‚   â”œâ”€â”€ Custo de Falso Positivo (R$ perdidos por bloqueio incorreto)          â”‚
â”‚   â”œâ”€â”€ Chargeback Rate (%)                                                   â”‚
â”‚   â””â”€â”€ Chargeback Amount (R$)                                                â”‚
â”‚                                                                              â”‚
â”‚   ğŸ“‹ COMPLIANCE                                                             â”‚
â”‚   â”œâ”€â”€ DecisÃµes Auditadas (#)                                                â”‚
â”‚   â”œâ”€â”€ Overrides Manuais (#)                                                 â”‚
â”‚   â”œâ”€â”€ Tempo de RetenÃ§Ã£o de Logs                                             â”‚
â”‚   â””â”€â”€ Blocklist Entries (#)                                                 â”‚
â”‚                                                                              â”‚
â”‚   ğŸ”§ EFETIVIDADE DAS REGRAS                                                 â”‚
â”‚   â”œâ”€â”€ Regra 1 (Clonagem): X fraudes detectadas                              â”‚
â”‚   â”œâ”€â”€ Regra 2 (Card Testing): X fraudes detectadas                          â”‚
â”‚   â”œâ”€â”€ ...                                                                   â”‚
â”‚   â””â”€â”€ Regra 8 (Age Mismatch): X fraudes detectadas                          â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“ Estrutura de Arquivos

```
fraud-detection-pipeline/
â”‚
â”œâ”€â”€ ğŸ“„ README.md                    # DocumentaÃ§Ã£o principal
â”œâ”€â”€ ğŸ“„ PROJECT_PLAN.md              # Este arquivo
â”œâ”€â”€ ğŸ“„ docker-compose.yml           # OrquestraÃ§Ã£o dos serviÃ§os
â”œâ”€â”€ ğŸ“„ .env                         # VariÃ¡veis de ambiente
â”‚
â”œâ”€â”€ ğŸ“‚ shadowtraffic/
â”‚   â”œâ”€â”€ ğŸ“„ license.env              # LicenÃ§a do ShadowTraffic
â”‚   â””â”€â”€ ğŸ“„ config.json              # ConfiguraÃ§Ã£o de geraÃ§Ã£o de dados
â”‚
â”œâ”€â”€ ğŸ“‚ spark/
â”‚   â””â”€â”€ ğŸ“‚ jobs/
â”‚       â”œâ”€â”€ ğŸ“‚ production/          # Jobs batch (Bronze/Silver/Gold)
â”‚       â”‚   â”œâ”€â”€ ğŸ“„ medallion_bronze.py
â”‚       â”‚   â”œâ”€â”€ ğŸ“„ medallion_silver.py
â”‚       â”‚   â””â”€â”€ ğŸ“„ medallion_gold.py
â”‚       â””â”€â”€ ğŸ“‚ streaming/           # Jobs streaming (Kafka â†’ MinIO)
â”‚           â”œâ”€â”€ ğŸ“„ streaming_bronze.py
â”‚           â”œâ”€â”€ ğŸ“„ streaming_silver.py
â”‚           â””â”€â”€ ğŸ“„ streaming_gold.py
â”‚
â”œâ”€â”€ ğŸ“‚ shadowtraffic/               # Gerador de dados streaming
â”‚   â”œâ”€â”€ ğŸ“„ license.env              # LicenÃ§a ShadowTraffic
â”‚   â””â”€â”€ ğŸ“„ transactions.json        # Config de geraÃ§Ã£o
â”‚
â”œâ”€â”€ ğŸ“‚ data/                        # DiretÃ³rio local (desenvolvimento)
â”‚   â”œâ”€â”€ ğŸ“‚ raw/
â”‚   â”œâ”€â”€ ğŸ“‚ bronze/
â”‚   â”œâ”€â”€ ğŸ“‚ silver/
â”‚   â””â”€â”€ ğŸ“‚ gold/
â”‚
â”œâ”€â”€ ğŸ“‚ docs/
â”‚   â”œâ”€â”€ ğŸ“„ architecture.md          # DocumentaÃ§Ã£o da arquitetura
â”‚   â”œâ”€â”€ ğŸ“„ data_dictionary.md       # DicionÃ¡rio de dados
â”‚   â”œâ”€â”€ ğŸ“„ fraud_rules.md           # DocumentaÃ§Ã£o das regras
â”‚   â””â”€â”€ ğŸ“‚ images/                  # Diagramas
â”‚
â””â”€â”€ ğŸ“‚ notebooks/
    â””â”€â”€ ğŸ“„ exploration.ipynb        # AnÃ¡lise exploratÃ³ria
```

---

## âœ… Checklist de Entrega

### ğŸ“Š RELATÃ“RIO DE STATUS (Dezembro 2025)

#### ğŸ‰ MARCO ALCANÃ‡ADO: 51GB de Dados Brasileiros Processados! ğŸ‡§ğŸ‡·

### ğŸŒ DASHBOARD PÃšBLICO ONLINE!

ğŸ”— **Acesse agora:** [Dashboard de Fraudes - Metabase](http://54.36.100.35:3000/public/dashboard/cd809bc2-c8cd-442e-afae-30a17ac50a0f)

> ğŸ“Š Dashboard com dados reais processados pelo pipeline - 48.4M transaÃ§Ãµes brasileiras!

| MÃ©trica | Valor |
|---------|-------|
| **TransaÃ§Ãµes Raw** | 51,281,996 |
| **TransaÃ§Ãµes Processadas** | 48,445,853 (5.5% limpeza) |
| **Dados Raw (JSON)** | 51 GB (479 arquivos) |
| **Clientes** | 100,000 (nomes brasileiros) |
| **Dispositivos** | 300,102 |
| **Tempo Total Pipeline** | ~34 min |
| **Throughput MÃ©dio** | ~85,000 tx/s |

**Tamanhos por Camada (MinIO):**
| Camada | Tamanho | CompressÃ£o |
|--------|---------|-----------|
| Bronze | 5.0 GB | 90% |
| Silver | 5.4 GB | 89% |
| Gold | 2.0 GB | 96% |
| **Total** | **12 GB** | **76%** |

#### âœ… O QUE ESTÃ IMPLEMENTADO

| Item | Status | ObservaÃ§Ãµes |
|------|--------|-------------|
| **Infraestrutura Docker** | âœ… | PostgreSQL, MinIO, Kafka, Zookeeper, Spark (1 Master + 5 Workers), Metabase |
| **Bronze Layer** | âœ… | `production/bronze_brazilian.py` - 51GB JSON â†’ 5GB Parquet |
| **Silver Layer** | âœ… | `production/silver_brazilian.py` - Limpeza e validaÃ§Ã£o |
| **Gold Layer** | âœ… | `production/gold_brazilian.py` - AgregaÃ§Ãµes e scoring |
| **Fraud Detection bÃ¡sico** | âœ… | 12/12 regras com sistema de pontuaÃ§Ã£o |
| **IntegraÃ§Ã£o MinIO** | âœ… | `s3a://fraud-data/medallion/{bronze,silver,gold}` |
| **IntegraÃ§Ã£o PostgreSQL** | âœ… | `load_to_postgres.py` |
| **GeraÃ§Ã£o de Dados Brasileiros** | âœ… | `generate_parallel.py` com Faker pt_BR |
| **Metabase** | âœ… | Dashboard PÃšBLICO: [Link](http://54.36.100.35:3000/public/dashboard/cd809bc2-c8cd-442e-afae-30a17ac50a0f) |
| **Streaming Pipeline** | âœ… | `streaming/streaming_*.py` |
| **Batch Pipeline** | âœ… | `production/*.py` |
| **DocumentaÃ§Ã£o Regras** | âœ… | `docs/REGRAS_FRAUDE.md` (14 regras documentadas) |
| **Escala 51GB** | âœ… | **ğŸ‰ NOVO! 51.2M transaÃ§Ãµes brasileiras em ~34min** |

#### ğŸŸ¡ O QUE ESTÃ PENDENTE

##### ğŸŸ  IMPORTANTE (MÃ©dio Impacto)

| Item | Planejado | Atual | AÃ§Ã£o NecessÃ¡ria |
|------|-----------|-------|------------------|
| **Regras de Fraude** | 12 regras | âœ… 12/12 | Todas implementadas! |
| **Streaming Pipeline** | ShadowTraffic â†’ Kafka â†’ Spark | ğŸ”„ Em progresso | Adicionar ShadowTraffic ao docker-compose |
| **Entidade Cards** | Tabela de cartÃµes | âŒ NÃ£o existe | Criar schema e dados |
| **Chargebacks** | Processamento de disputas | âŒ NÃ£o existe | Criar pipeline |
| **Blocklist** | Lista de bloqueio | âŒ NÃ£o existe | Criar tabela e lÃ³gica |
| **Audit Log** | Log de compliance | âŒ NÃ£o existe | Implementar logging |

##### ğŸŸ¡ DESEJÃVEL (Baixo Impacto)

| Item | Planejado | Atual | AÃ§Ã£o NecessÃ¡ria |
|------|-----------|-------|-----------------|
| **Notebooks** | `notebooks/exploration.ipynb` | âŒ NÃ£o existe | Criar anÃ¡lise exploratÃ³ria |
| **DicionÃ¡rio de Dados** | `docs/data_dictionary.md` | âŒ NÃ£o existe | Documentar campos |
| **Arquitetura Doc** | `docs/architecture.md` | âŒ NÃ£o existe | Criar diagrama |

#### ğŸ“‹ REGRAS DE FRAUDE: Planejado vs. Implementado

| # | Regra Planejada | Status | ImplementaÃ§Ã£o Atual |
|---|-----------------|--------|---------------------|
| 1 | **Clonagem** (mesma conta, cidades diferentes, <30min) | âœ… | `is_cloning_suspect` - Window function: tempo < 60min + distÃ¢ncia > 555km + estados diferentes |
| 2 | **Velocidade ImpossÃ­vel** (deslocamento impossÃ­vel) | âœ… | `is_impossible_velocity` - Velocidade > 900 km/h entre transaÃ§Ãµes |
| 3 | **Gasto Anormal** (valor > 5x mÃ©dia 30d) | âœ… | `is_high_value` - Valor > 5x mÃ©dia 30 dias do cliente |
| 4 | **Account Takeover** (device desconhecido + >R$500) | âŒ | Falta entidade Devices |
| 5 | **Anomalia GeogrÃ¡fica** (GPS mismatch) | âœ… | `is_gps_mismatch` - DistÃ¢ncia GPS > 20 graus (~2222km) |
| 6 | **HorÃ¡rio AtÃ­pico** (2h-5h da manhÃ£) | âœ… | `is_night_transaction` - TransaÃ§Ãµes entre 2h-5h |
| 7 | **Categoria Suspeita** (eletrÃ´nicos, passagens) | âœ… | `is_risky_category` - Categorias: electronics, airline_ticket |
| 8 | **Incompatibilidade de Idade** (perfil vs compra) | âŒ | Falta campo idade no schema |
| 9 | **Online Alto Valor** (compra online > R$1000) | âœ… | `is_online_high_value` - Online + valor > R$ 1.000 |
| 10 | **Muitas Parcelas** (10+ parcelas + valor > R$500) | âœ… | `is_many_installments` - Parcelamento diluÃ­do |
| 11 | **Cross-State sem HistÃ³rico** | âœ… | `is_cross_state` - Estado diferente + sem viagem nos Ãºltimos 12m |
| 12 | **Alta Velocidade** (15+ tx/24h) | âœ… | `is_high_velocity` - Mais de 15 transaÃ§Ãµes em 24h |

**Resumo:** 12 completas, todas as regras implementadas! âœ…

#### ğŸ¯ SISTEMA DE PONTUAÃ‡ÃƒO (Fraud Score)

| Fator | Pontos | CondiÃ§Ã£o |
|-------|--------|----------|
| Cross-state | 2 | Estado diferente sem histÃ³rico viagem |
| Noturno | 3 | Entre 2h-5h |
| Alto valor | 3 | > 5x mÃ©dia 30d |
| Alta velocidade | 5 | > 15 tx/24h |
| GPS mismatch | 5 | DistÃ¢ncia > 20Â° |
| Categoria risco | 4 | EletrÃ´nicos/Passagens |
| Online alto valor | 5 | Online + > R$1000 |
| Muitas parcelas | 4 | 10+ parcelas + > R$500 |
| **Clonagem** | **25** | Tempo < 60min + dist > 555km |
| **Velocidade impossÃ­vel** | **40** | > 900 km/h entre tx |
| CombinaÃ§Ãµes 2 fatores | 8-15 | VÃ¡rias combinaÃ§Ãµes |
| CombinaÃ§Ãµes 3+ fatores | 20-40 | CombinaÃ§Ãµes extremas |

**NÃ­veis de Risco:**
- âœ… **NORMAL** (score < 10) - ~90%
- ğŸŸ¢ **BAIXO** (10-17) - ~0.5%
- ğŸŸ  **MÃ‰DIO** (18-29) - ~2.3%
- ğŸŸ¡ **ALTO** (30-49) - ~2.1%
- ğŸ”´ **CRÃTICO** (50+) - ~4.9%

#### ğŸ¯ FASES DO PROJETO: Status Atual

| Fase | DescriÃ§Ã£o | Status | % |
|------|-----------|--------|---|
| **FASE 1** | Ambiente Docker + Dados | âœ… Completo | 100% |
| **FASE 2** | Pipeline Bronze/Silver/Gold | âœ… Completo | 100% |
| **FASE 3** | Regras de Fraude (12 regras) | âœ… **12/12 implementadas** | 100% |
| **FASE 4** | Operacional (Audit/Blocklist/Chargeback) | âŒ NÃ£o iniciado | 0% |
| **FASE 5** | VisualizaÃ§Ã£o (Metabase + Traefik) | âœ… **Completo!** ğŸŒ | 100% |
| **FASE 6** | Escala 50GB + DocumentaÃ§Ã£o | âœ… **51GB processados!** ğŸ‰ | 100% |
| **FASE 7** | Streaming Real-Time | âœ… **Completo!** ğŸŒŠ | 100% |
| **FASE 7** | Streaming Real-time | ğŸ”„ **Em progresso** | 50% |

#### ğŸš€ PRÃ“XIMOS PASSOS RECOMENDADOS

##### Prioridade 1 (Esta semana)
1. âœ… ~~Implementar as **regras de fraude**~~ **FEITO! 12/12 regras**
2. âœ… ~~Adicionar **Metabase** ao docker-compose~~ **FEITO! Porta 3000**
3. âœ… ~~Escalar para **50GB de dados**~~ **SUPERADO! 51GB processados**
4. âœ… ~~Adicionar **Traefik**~~ **FEITO! HTTPS habilitado**
5. ğŸ”„ Implementar **Streaming Real-time** com ShadowTraffic

##### Prioridade 2 (PrÃ³xima semana)
6. â¬œ Criar entidades **Cards** (para regra Account Takeover)
7. â¬œ Implementar **Chargebacks** pipeline
8. â¬œ Criar **Blocklist** e **Audit Log**

##### Prioridade 3 (Semana 3)
9. â¬œ Completar **documentaÃ§Ã£o** (README, architecture, data dictionary)
10. â¬œ Post no **LinkedIn** sobre o projeto

---

### CHECKLIST ORIGINAL

### FASE 1: Ambiente âœ…

- [x] VPS configurada e acessÃ­vel
- [x] Docker e Docker Compose instalados
- [x] Todos os containers rodando
- [x] ShadowTraffic gerando dados de teste (streaming)

### FASE 2: Pipeline âœ…

- [x] Bronze layer funcionando
- [x] Silver layer com dados limpos
- [x] Gold layer com mÃ©tricas
- [x] Dados salvos no MinIO

### FASE 3: Fraude âœ…

- [x] 12 regras implementadas (12/12 total)
- [x] Fraud score calculado
- [x] ClassificaÃ§Ã£o BAIXO/MÃ‰DIO/ALTO/CRÃTICO
- [ ] Audit log registrando decisÃµes

### FASE 4: Operacional

- [ ] Chargebacks processados
- [ ] Blocklist funcionando
- [ ] MÃ©tricas de SLA calculadas
- [x] KPIs de negÃ³cio prontos

### FASE 5: VisualizaÃ§Ã£o

- [x] Dashboard Metabase configurado
- [x] GrÃ¡ficos principais criados
- [x] Acesso externo via Traefik (HTTPS)
- [x] URLs pÃºblicas com SSL Let's Encrypt

### FASE 6: DocumentaÃ§Ã£o

- [x] README completo
- [x] Diagramas de arquitetura
- [ ] DicionÃ¡rio de dados
- [x] RepositÃ³rio GitHub pÃºblico
- [ ] Post no LinkedIn

---

## ğŸ¯ Resultado Final

Ao completar o projeto, vocÃª terÃ¡:

| EntregÃ¡vel | DescriÃ§Ã£o |
|------------|-----------|
| **RepositÃ³rio GitHub** | CÃ³digo completo + documentaÃ§Ã£o profissional |
| **Pipeline funcionando** | 50GB processados na sua VPS |
| **Dashboards online** | AcessÃ­veis de qualquer lugar |
| **DocumentaÃ§Ã£o tÃ©cnica** | Arquitetura, dicionÃ¡rio, regras |
| **Post LinkedIn** | Showcase do projeto |
| **Conhecimento prÃ¡tico** | Spark, Kafka, Data Lake, Fraud Detection |

---

## ğŸ› ï¸ Stack TecnolÃ³gico

| Categoria | Tecnologia | VersÃ£o | Status |
|-----------|------------|--------|--------|
| **GeraÃ§Ã£o de Dados** | ShadowTraffic | Latest | âœ… Funcionando (Streaming) |
| **GeraÃ§Ã£o de Dados** | Python + Faker pt_BR | 3.11 | âœ… Funcionando |
| **Mensageria** | Apache Kafka | 7.5.0 | âœ… Funcionando |
| **CoordenaÃ§Ã£o** | Zookeeper | 7.5.0 | âœ… Funcionando |
| **Processamento** | Apache Spark | 3.5.3 | âœ… Funcionando |
| **Processamento** | Spark Structured Streaming | 3.5.3 | âœ… Funcionando |
| **Linguagem** | PySpark / Python | 3.11 | âœ… Funcionando |
| **Data Lake** | MinIO | Latest | âœ… Funcionando |
| **Formato** | Parquet | - | âœ… Funcionando |
| **Banco de Dados** | PostgreSQL | 16 | âœ… Funcionando |
| **BI** | Metabase | Latest | âœ… Funcionando |
| **Proxy** | Traefik | Latest | âœ… Funcionando |
| **Containers** | Docker / Docker Compose | Latest | âœ… Funcionando |
| **SO** | Ubuntu | 25.04 | âœ… Funcionando |

---

## ğŸ“ Recursos e ReferÃªncias

### DocumentaÃ§Ã£o Oficial

- [ShadowTraffic Docs](https://docs.shadowtraffic.io/)
- [Apache Spark](https://spark.apache.org/docs/latest/)
- [Delta Lake](https://docs.delta.io/)
- [MinIO](https://min.io/docs/)
- [Kafka](https://kafka.apache.org/documentation/)

### Exemplos de Fraude Detection

- [Nubank Engineering Blog](https://building.nubank.com.br/)
- [Netflix Tech Blog](https://netflixtechblog.com/)
- [Uber Engineering](https://eng.uber.com/)

---

## ğŸ“ Notas

Este plano foi criado em novembro de 2025 como guia para construÃ§Ã£o de um projeto de portfÃ³lio em Data Engineering com foco em detecÃ§Ã£o de fraudes financeiras.

**Autor:** Abner Borda Fonseca  
**Objetivo:** TransiÃ§Ã£o de carreira para Data Engineering (nÃ­vel Pleno)  
**Prazo estimado:** 6 semanas
